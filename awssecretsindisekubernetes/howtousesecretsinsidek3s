  1. Attach this IAM Role to your EC2 instance (the node running K3s):

2. Install External Secrets Operator (ESO) on K3s  
kubectl apply -f https://github.com/external-secrets/external-secrets/releases/latest/download/crds.yaml
kubectl apply -f https://github.com/external-secrets/external-secrets/releases/latest/download/eso-controller.yaml
  
kubectl get pods -n external-secrets

output like external-secrets-xxxxx Running

3. Create a SecretStore (K3s â†’ AWS REGION)

secretstore.yaml   
kubectl apply -f secretstore.yaml
  Create an ExternalSecret (fetch from AWS Secrets Manager)
5. myapp/mysql in aws secret manager with this name
{
  "DB_HOST": "xxxxx",
  "DB_USER": "xxxxx",
  "DB_PASSWORD": "xxxxx",
  "DB_NAME": "xxxxx"
}

6. externalsecret.yaml 
kubectl apply -f externalsecret.yaml
kubectl get secrets
output db-secret
kubectl describe secret db-secret
7.kubectl apply -f deployment.yaml
